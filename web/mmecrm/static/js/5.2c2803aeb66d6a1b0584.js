webpackJsonp([5],{"0X7H":function(t,e){var a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=["January","February","March","April","May","June","July","August","September","October","November","December"],s={getDuration:function(t){var e=new Date(t);e.getMonth();return e.setMonth(e.getMonth()+1),e.setDate(0),e.getDate()},changeDay:function(t,e){var a=new Date(t);return new Date(a.setDate(a.getDate()+e))},getStartDate:function(t){return new Date(t.getFullYear(),t.getMonth(),1)},getEndDate:function(t){var e=new Date(t.getFullYear(),t.getMonth()+1,1);return new Date(e.setDate(e.getDate()-1))},format:function(t,e,s){s=s||n;var i={M:(t="string"==typeof t?new Date(t.replace(/-/g,"/")):new Date(t)).getMonth()+1,d:t.getDate(),h:t.getHours(),m:t.getMinutes(),s:t.getSeconds(),q:Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};return e=e.replace(/([yMdhmsqS])+/g,function(e,n){var r=i[n];return void 0!==r?"MMMM"===e?s[r-1]:"MMM"===e?a[r-1]:(e.length>1&&(r=(r="0"+r).substr(r.length-2)),r):"y"===n?String(t.getFullYear()).substr(4-e.length):e})}};t.exports=s},5383:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("gmQn"),s=a("0X7H"),i=a.n(s),r={data:function(){return{base:{first_day:1,week_names:["一","二","三","四","五","六","日"]},date_list:{}}},created:function(){this.getCalendar()},props:["current","events"],methods:{click_date:function(t){this.$emit("clickDate",t)},click_event:function(t){this.$emit("clickEvent",t)},getCalendar:function(){var t=new Date,e=new Date(this.current),a=i.a.getStartDate(e),n=a.getDay(),s=i.a.getEndDate(e),r=parseInt(this.base.first_day)-n;r=r>0?r-7:r;var o=parseInt(Math.abs(r)+s.getDate()),c=o%7==0?parseInt(o/7):parseInt(o/7)+1;a.setDate(a.getDate()+r);for(var l=[],u=0;u<c;u++){for(var h=[],v=0;v<7;v++)h.push({monthDay:a.getDate(),isCurMonth:a.getMonth()==e.getMonth(),isToday:t.toDateString()==a.toDateString(),isCurrent:e.toDateString()==a.toDateString(),weekDay:v,date:i.a.format(a,"yyyy-MM-dd"),events:this.$options.methods.getEventList(i.a.format(a,"yyyy-MM-dd"),this.events)}),a.setDate(a.getDate()+1);l.push(h)}this.date_list=l},getEventList:function(t,e){for(var a=[],n=0;n<e.length;n++)e[n].start==t&&a.push(e[n]);return a}},watch:{current:{handler:function(t){this.getCalendar()}},events:{handler:function(t){this.getCalendar()}}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"calendar-month"},[a("table",{staticClass:"calendar-table",attrs:{border:"0",cellspacing:"0",cellpadding:"0"}},[a("thead",[a("tr",t._l(t.base.week_names,function(e){return a("td",[t._v(t._s(e))])}),0)]),t._v(" "),a("tbody",t._l(t.date_list,function(e){return a("tr",t._l(e,function(e){return a("td",{class:e.isCurrent?"current":"",on:{click:function(a){return t.click_date(e.date)}}},[a("span",{class:e.isCurMonth?"":"last",attrs:{title:e.date}},[t._v(t._s(e.monthDay))]),t._v(" "),a("div",{staticClass:"day-events"},[a("happy-scroll",{staticStyle:{width:"100%",height:"100%"},attrs:{color:"rgba(0,0,0,0.3)",size:"3","hide-horizontal":""}},[a("div",{staticClass:"day-events-list"},t._l(e.events,function(e){return a("a",{staticClass:"day-events-item",class:e.class,attrs:{title:e.title},on:{click:function(a){return t.click_event(e.id)}}},[t._v(t._s(e.title))])}),0)])],1)])}),0)}),0)])])},staticRenderFns:[]};var c=a("VU/8")(r,o,!1,function(t){a("INUP"),a("WYco")},"data-v-2da6b049",null).exports,l=a("PJh5"),u=a.n(l),h={data:function(){return{is_month:!0,month_list:[],year_list:[],select_month:"",select_year:"",monthActivity:{underWayCount:0,monthCompleteCount:0,monthTotalCount:0,yearCompleteCount:0,yearTotalCount:0,events:[],current:u()(new Date,"YYYY-MM-DD")},yearActivity:{underWayCount:0,yearCompleteCount:0,yearTotalCount:0,map:{}}}},created:function(){this.$parent.init_pages(),this.data_init()},methods:{data_init:function(){for(var t=2009;t<=2029;t++)this.year_list.push(t);for(var e=1;e<=12;e++){var a=e>9?e:"0"+e;this.month_list.push({name:e+"月",value:a})}var n=new Date;this.select_year=n.getFullYear();var s=n.getMonth()+1;this.select_month=s>9?s:"0"+s},change_year:function(){this.is_month=!1},change_month:function(){this.is_month=!0,this.get_month_data()},get_year_data:function(){var t=this;return n.a.request({methods:"get",url:"activity/year",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8;"},params:{begin:this.select_year+"-01-01",end:this.select_year+"-12-31"}}).then(function(e){t.yearActivity.underWayCount=e.data.underWayCount,t.yearActivity.yearCompleteCount=e.data.yearCompleteCount,t.yearActivity.yearTotalCount=e.data.yearTotalCount,t.yearActivity.map=e.data.map}).catch(function(t){console.log(t)})},get_month_data:function(){var t=this,e=new Date(this.monthActivity.current);this.monthActivity.current=this.select_year+"-"+this.select_month+"-"+e.getDate();var a=new Date(this.select_year,this.select_month,0).getDate();return n.a.request({methods:"get",url:"activity/month",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8;"},params:{begin:this.$options.methods.getDate(this.select_year+"-"+this.select_month+"-1",-7),end:this.$options.methods.getDate(this.select_year+"-"+this.select_month+"-"+a,7)}}).then(function(e){for(var a in t.monthActivity.underWayCount=e.data.underWayCount,t.monthActivity.monthCompleteCount=e.data.monthCompleteCount,t.monthActivity.monthTotalCount=e.data.monthTotalCount,t.monthActivity.yearCompleteCount=e.data.yearCompleteCount,t.monthActivity.yearTotalCount=e.data.yearTotalCount,t.monthActivity.events=[],e.data.list)for(var n=e.data.list[a],s=0;s<n.length;s++)3==n[s].state?t.monthActivity.events.push({title:n[s].name,start:n[s].day,class:"state1",id:n[s].id}):4==n[s].state?t.monthActivity.events.push({title:n[s].name,start:n[s].day,class:"state2",id:n[s].id}):5==n[s].state?t.monthActivity.events.push({title:n[s].name,start:n[s].day,class:"state3",id:n[s].id}):6==n[s].state?t.monthActivity.events.push({title:n[s].name,start:n[s].day,class:"state5",id:n[s].id}):-3==n[s].state&&t.monthActivity.events.push({title:n[s].name,start:n[s].day,class:"state4",id:n[s].id})}).catch(function(t){console.log(t)})},month_click:function(t){this.select_month=t,this.is_month=!0},date_click:function(t){var e=new Date(t);this.select_year=e.getFullYear(),this.select_month=e.getMonth()>9?e.getMonth()+1:"0"+(e.getMonth()+1),this.monthActivity.current=t},event_click:function(t){this.$router.push({name:"preview",params:{id:t}})},getDate:function(t,e){if(!e)return t;e=Math.floor(e);var a="/";t.indexOf("-")>-1?(a="-",t=t.replace(/-/g,"/")):t.indexOf(".")>-1&&(a=".",t=t.replace(/\./g,"/"));var n=new Date(t),s=new Date(Number(n)+864e5*e),i=s.getFullYear(),r=s.getMonth()+1,o=s.getDate();return i+a+(r<10?"0"+r:r)+a+(o<10?"0"+o:o)}},watch:{select_year:{handler:function(t){this.get_year_data(),this.get_month_data()}},select_month:{handler:function(t){this.get_month_data()}}},components:{"calendar-month":c}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main calendar-list"},[a("div",{staticClass:"markingCalendar"},[a("div",{staticClass:"calendar-left"},[t.is_month?[a("div",{staticClass:"title"},[a("span",[t._v(t._s(t.select_year)+"年营销"+t._s(t.select_month)+"月情况概览")])]),t._v(" "),a("ul",{staticClass:"summary"},[a("li",[a("span",{staticClass:"item-name"},[t._v("执行中")]),t._v(" "),a("span",[t._v(t._s(t.monthActivity.underWayCount))])]),t._v(" "),a("li",[a("span",{staticClass:"item-name"},[t._v("完成/月总数")]),t._v(" "),a("span",[t._v(t._s(t.monthActivity.monthCompleteCount)+"/"+t._s(t.monthActivity.monthTotalCount))])]),t._v(" "),a("li",[a("span",{staticClass:"item-name"},[t._v("完成/年总数")]),t._v(" "),a("span",[t._v(t._s(t.monthActivity.yearCompleteCount)+"/"+t._s(t.monthActivity.yearTotalCount))])])])]:[a("div",{staticClass:"title"},[a("span",[t._v(t._s(t.select_year)+"年营销情况概览")])]),t._v(" "),a("ul",{staticClass:"summary"},[a("li",[a("span",{staticClass:"item-name"},[t._v("执行中")]),t._v(" "),a("span",[t._v(t._s(t.yearActivity.underWayCount))])]),t._v(" "),a("li",[a("span",{staticClass:"item-name"},[t._v("完成/年总数")]),t._v(" "),a("span",[t._v(t._s(t.yearActivity.yearCompleteCount)+"/"+t._s(t.yearActivity.yearTotalCount))])])])],t._v(" "),t._m(0)],2),t._v(" "),a("div",{staticClass:"calendar-right"},[a("div",{staticClass:"nav-right"},[a("div",{staticClass:"selecte-box"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.select_year,expression:"select_year"}],staticClass:"date-color",attrs:{autocomplete:"off"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.select_year=e.target.multiple?a:a[0]}}},t._l(t.year_list,function(e){return a("option",{domProps:{value:e}},[t._v(t._s(e))])}),0),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.select_month,expression:"select_month"}],staticClass:"date-color",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.select_month=e.target.multiple?a:a[0]}}},t._l(t.month_list,function(e){return a("option",{domProps:{value:e.value}},[t._v(t._s(e.name))])}),0)]),t._v(" "),a("ul",{staticClass:"date-box"},[a("li",{class:t.is_month?"active":"",on:{click:t.change_month}},[t._v("月")]),t._v(" "),a("li",{class:t.is_month?"":"active",on:{click:t.change_year}},[t._v("年")])])]),t._v(" "),t.is_month?a("div",{staticClass:"calendar-box"},[a("calendar-month",{attrs:{current:t.monthActivity.current,events:t.monthActivity.events},on:{clickDate:t.date_click,clickEvent:t.event_click}})],1):a("div",{staticClass:"main-year"},[a("ul",{staticClass:"year-list"},t._l(t.month_list,function(e){return a("li",{class:e.value==t.select_month?"show":"",on:{click:function(a){return t.month_click(e.value)}}},[t._v(t._s(e.name)+"\n            "),a("div",{staticClass:"year-view"},[t._l(t.yearActivity.map[t.select_year+"-"+e.value],function(e){return[3===e.state?a("span",{staticClass:"yearState start"},[t._v(t._s(e.count))]):4===e.state?a("span",{staticClass:"yearState completed"},[t._v(t._s(e.count))]):5===e.state?a("span",{staticClass:"yearState pause"},[t._v(t._s(e.count))]):-3===e.state?a("span",{staticClass:"yearState err"},[t._v(t._s(e.count))]):6===e.state?a("span",{staticClass:"yearState end"},[t._v(t._s(e.count))]):t._e()]})],2)])}),0)])])])])},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{staticClass:"legend"},[a("li",[a("span",{staticClass:"start"}),t._v(" "),a("span",[t._v("进行中")])]),t._v(" "),a("li",[a("span",{staticClass:"completed"}),t._v(" "),a("span",[t._v("已完成")])]),t._v(" "),a("li",[a("span",{staticClass:"pause"}),t._v(" "),a("span",[t._v("已暂停")])]),t._v(" "),a("li",[a("span",{staticClass:"err"}),t._v(" "),a("span",[t._v("执行异常")])]),t._v(" "),a("li",[a("span",{staticClass:"end"}),t._v(" "),a("span",[t._v("已结束")])])])}]};var _=a("VU/8")(h,v,!1,function(t){a("ZxAy")},"data-v-222e7d26",null);e.default=_.exports},INUP:function(t,e){},WYco:function(t,e){},ZxAy:function(t,e){}});